<!DOCTYPE html>
<html>
<head><meta charset="UTF-8"><title>BashMessage â€“ odesÃ­lÃ¡nÃ­ zprÃ¡v z pÅ™Ã­kazovÃ© Å™Ã¡dky linuxu</title></head>
<body>
<h1>OdesÃ­lÃ¡nÃ­ a pÅ™Ã­jem zprÃ¡vy pomocÃ­ <code>ncat</code> a <code>nc</code> s <code>tcpdump</code> ğŸš€</h1>
<p>Tento nÃ¡vod ukazuje, jak pouÅ¾Ã­vat <strong><code>tcpdump</code></strong> pro naslouchÃ¡nÃ­ a logovÃ¡nÃ­ UDP paketÅ¯ a jak odesÃ­lat zprÃ¡vy pomocÃ­ <strong><code>ncat</code></strong> nebo <strong><code>nc</code></strong>. VÅ¡e s pÅ™idanÃ½m logovÃ¡nÃ­m do souboru pro snadnou kontrolu zprÃ¡v. ğŸ“‚</p>
<h2>Co budete potÅ™ebovat ğŸ› ï¸</h2>
<ol>
<li><strong>Ubuntu</strong> (nebo jinÃ© Linux distro, ale pro tento pÅ™Ã­klad pÅ™edpoklÃ¡dÃ¡me Ubuntu ğŸ§).</li>
<li><strong><code>tcpdump</code></strong> pro naslouchÃ¡nÃ­ a logovÃ¡nÃ­ paketÅ¯.</li>
<li><strong><code>ncat</code></strong> (souÄÃ¡st balÃ­ku <strong>Nmap</strong>) pro odesÃ­lÃ¡nÃ­ zprÃ¡v pÅ™es UDP ğŸ“¡.</li>
<li><strong><code>nc</code></strong> pro odesÃ­lÃ¡nÃ­ zprÃ¡v (alternativa k <code>ncat</code>) ğŸ’¬.</li>
<li>OprÃ¡vnÄ›nÃ­ pro spuÅ¡tÄ›nÃ­ <strong><code>tcpdump</code></strong> (obvykle jako root nebo pomocÃ­ <code>sudo</code>).</li>
</ol>
<h3>Instalace potÅ™ebnÃ½ch nÃ¡strojÅ¯ (pro Ubuntu) ğŸ“¦</h3>
<p>NejdÅ™Ã­ve je tÅ™eba nainstalovat <strong><code>tcpdump</code></strong>, <strong><code>nmap</code></strong> (pro <code>ncat</code>), a <strong><code>netcat</code></strong> (pro <code>nc</code>).</p>
<p>SpusÅ¥te nÃ¡sledujÃ­cÃ­ pÅ™Ã­kazy:</p>
<p>sudo apt update<br />
sudo apt install tcpdump nmap netcat  </p>
<p>TÃ­mto zÃ­skÃ¡te vÅ¡echny potÅ™ebnÃ© nÃ¡stroje. âœ…</p>
<h2>1. NaslouchÃ¡nÃ­ s <code>tcpdump</code> ğŸ”</h2>
<p>Na poÄÃ­taÄi, kterÃ½ bude pÅ™ijÃ­mat zprÃ¡vy, pouÅ¾ijte nÃ¡sledujÃ­cÃ­ pÅ™Ã­kaz pro naslouchÃ¡nÃ­ na specifikovanÃ©m UDP portu a IP adrese.</p>
<h3>PÅ™Ã­kaz pro naslouchÃ¡nÃ­ na UDP portu a IP:</h3>
<p>sudo tcpdump -i eth0 -v -A udp and host 10.20.1.4 and port 4444</p>
<h3>VysvÄ›tlenÃ­ parametrÅ¯:</h3>
<ul>
<li><code>-i eth0</code> â€“ UrÄuje sÃ­Å¥ovÃ© rozhranÃ­, na kterÃ©m <strong><code>tcpdump</code></strong> bude poslouchat. Na Ubuntu mÅ¯Å¾e bÃ½t toto rozhranÃ­ rÅ¯znÃ©, napÅ™. <code>enp3s0</code>, <code>wlan0</code> nebo jinÃ½ nÃ¡zev. Zkontrolujte svÅ¯j nÃ¡zev sÃ­Å¥ovÃ©ho rozhranÃ­ pÅ™Ã­kazem <code>ip a</code>.</li>
<li><code>-v</code> â€“ VerbÃ³znÃ­ reÅ¾im pro zobrazenÃ­ podrobnostÃ­ o kaÅ¾dÃ©m zachycenÃ©m paketu.</li>
<li><code>-A</code> â€“ Zobrazuje obsah paketÅ¯ v textovÃ©m (ASCII) formÃ¡tu.</li>
<li><code>udp</code> â€“ Filtruje pouze UDP pakety.</li>
<li><code>and host 10.20.1.4</code> â€“ Filtruje provoz pouze z nebo na specifikovanou IP adresu (v tomto pÅ™Ã­padÄ› <code>10.20.1.4</code>).</li>
<li><code>and port 4444</code> â€“ Filtruje provoz pouze na UDP portu <strong>4444</strong>.</li>
</ul>
<h2>2. OdesÃ­lÃ¡nÃ­ zprÃ¡vy (varianta 1: pomocÃ­ <code>ncat</code>) ğŸ“¨</h2>
<p>Tato varianta pouÅ¾Ã­vÃ¡ <strong><code>ncat</code></strong> k odeslÃ¡nÃ­ zprÃ¡vy pÅ™es UDP protokol na specifikovanÃ½ port a IP adresu.</p>
<h3>PÅ™Ã­kaz pro odeslÃ¡nÃ­ zprÃ¡vy:</h3>
<p>echo -n "Ahoj, toto je testovacÃ­ zprÃ¡va!" | ncat -vu 10.20.1.4 4444</p>
<h3>VysvÄ›tlenÃ­ parametrÅ¯:</h3>
<ul>
<li><code>echo -n "Ahoj, toto je testovacÃ­ zprÃ¡va!"</code> â€“ OdesÃ­lÃ¡ zprÃ¡vu (s parametrem <code>-n</code> pro vynechÃ¡nÃ­ novÃ©ho Å™Ã¡dku na konci).</li>
<li><code>ncat -vu</code> â€“ PouÅ¾Ã­vÃ¡ <strong><code>ncat</code></strong> pro odeslÃ¡nÃ­ zprÃ¡vy. <code>-v</code> pro verbÃ³znÃ­ vÃ½stup a <code>-u</code> pro UDP komunikaci.</li>
<li><code>10.20.1.4</code> â€“ IP adresa cÃ­lovÃ©ho poÄÃ­taÄe.</li>
<li><code>4444</code> â€“ UDP port, na kterÃ½ se zprÃ¡va odesÃ­lÃ¡.</li>
</ul>
<h2>3. OdesÃ­lÃ¡nÃ­ zprÃ¡vy (varianta 2: pomocÃ­ <code>nc</code>) ğŸ’¬</h2>
<p>Tato varianta pouÅ¾Ã­vÃ¡ <strong><code>nc</code></strong> pro odesÃ­lÃ¡nÃ­ zprÃ¡vy na specifikovanou IP adresu a port. Pokud nemÃ¡te <strong><code>ncat</code></strong>, mÅ¯Å¾ete pouÅ¾Ã­t <strong><code>nc</code></strong>, kterÃ½ je Äasto pÅ™edinstalovÃ¡n v systÃ©mech.</p>
<h3>PÅ™Ã­kaz pro odeslÃ¡nÃ­ zprÃ¡vy:</h3>
<p>echo -n "Ahoj, toto je testovacÃ­ zprÃ¡va!" | nc -vu 10.20.1.4 4444</p>
<h3>VysvÄ›tlenÃ­ parametrÅ¯:</h3>
<ul>
<li><code>echo -n "Ahoj, toto je testovacÃ­ zprÃ¡va!"</code> â€“ OdesÃ­lÃ¡ zprÃ¡vu.</li>
<li><code>nc -vu</code> â€“ PouÅ¾Ã­vÃ¡ <strong><code>nc</code></strong> pro odesÃ­lÃ¡nÃ­ zprÃ¡vy. <code>-v</code> pro verbÃ³znÃ­ vÃ½stup a <code>-u</code> pro UDP komunikaci.</li>
<li><code>10.20.1.4</code> â€“ IP adresa cÃ­lovÃ©ho poÄÃ­taÄe.</li>
<li><code>4444</code> â€“ UDP port, na kterÃ½ se zprÃ¡va odesÃ­lÃ¡.</li>
</ul>
<h2>4. LogovÃ¡nÃ­ UDP zprÃ¡v do souboru ğŸ“œ</h2>
<p>Pro snadnÃ© logovÃ¡nÃ­ pÅ™ijatÃ½ch zprÃ¡v pouÅ¾ijeme <strong><code>tcpdump</code></strong> s pÅ™esmÄ›rovÃ¡nÃ­m vÃ½stupu do souboru. Tento soubor pak mÅ¯Å¾ete pouÅ¾Ã­t pro kontrolu zprÃ¡v.</p>
<h3>PÅ™Ã­kaz pro logovÃ¡nÃ­ zprÃ¡v do souboru:</h3>
<p>sudo tcpdump -vAi eth0 host 10.20.1.4 and port 4444 &gt;&gt; $HOME/messagesncat.log</p>
<h3>VysvÄ›tlenÃ­ parametrÅ¯:</h3>
<ul>
<li><code>-vA</code> â€“ VerbÃ³znÃ­ reÅ¾im pro podrobnosti o paketech a ASCII vÃ½stup pro textovou podobu dat.</li>
<li><code>-i eth0</code> â€“ SÃ­Å¥ovÃ© rozhranÃ­ pro naslouchÃ¡nÃ­ (nahraÄte <code>eth0</code> podle potÅ™eby).</li>
<li><code>&gt;&gt; $HOME/messagesncat.log</code> â€“ PÅ™esmÄ›ruje vÃ½stup <strong><code>tcpdump</code></strong> do souboru <code>messagesncat.log</code> ve vaÅ¡em domovskÃ©m adresÃ¡Å™i. <strong><code>&gt;&gt;</code></strong> znamenÃ¡, Å¾e novÃ© zprÃ¡vy budou <strong>pÅ™idÃ¡ny</strong> k jiÅ¾ existujÃ­cÃ­mu obsahu souboru. Pokud chcete soubor pÅ™epsat, pouÅ¾ijte <strong><code>&gt;</code></strong> (napÅ™. <code>&gt; $HOME/messagesncat.log</code>).</li>
</ul>
<h3>ZobrazenÃ­ logovanÃ½ch zprÃ¡v:</h3>
<p>Pokud chcete zobrazit obsah logu, pouÅ¾ijte pÅ™Ã­kaz:</p>
<p>cat $HOME/messagesncat.log</p>
<p><strong>DÅ¯leÅ¾itÃ© rozdÃ­ly mezi <code>&gt;</code> a <code>&gt;&gt;</code>:</strong>
- <strong><code>&gt;</code></strong> pÅ™epÃ­Å¡e obsah souboru (zÃ¡znamy budou ztraceny).
- <strong><code>&gt;&gt;</code></strong> pÅ™idÃ¡ novÃ© zÃ¡znamy na konec souboru, aniÅ¾ by pÅ™epsal jeho obsah.</p>
<h2>5. VÃ½stup z <code>tcpdump</code> ğŸ¯</h2>
<p>Pokud vÅ¡e probÃ­hÃ¡ sprÃ¡vnÄ›, <strong><code>tcpdump</code></strong> na serveru (poÄÃ­tÃ¡ se, Å¾e server naslouchÃ¡ na IP <code>10.20.1.4</code> a portu 4444) zachytÃ­ tento UDP paket a zobrazÃ­ vÃ½stup podobnÃ½ tomuto:</p>
<p>10:10:10.123456 IP (tos 0x0, ttl 64, id 12345, offset 0, flags [none], proto UDP (17), length 60)<br />
    10.20.1.4.4444 &gt; 10.20.1.10.12345: [bad udp cksum 0x1234 -&gt; 0x4321!] UDP, length 32<br />
        0x0000:  4500 003c 3039 4000 4011 0000 0a14 01f4<br />
        0x0010:  0a14 01f6 01bb 1155 0016 89ab 6162 6364<br />
        0x0020:  6869 2c20 746f 746f 2069 7320 7465 7374<br />
        0x0030:  696e 6720 7a70 7261 7661 2100  </p>
<h3>VysvÄ›tlenÃ­ vÃ½stupu:</h3>
<ul>
<li><strong><code>10:10:10.123456</code></strong> â€“ ÄŒasovÃ½ razÃ­tko, kdy paket pÅ™iÅ¡el.</li>
<li><strong><code>IP 10.20.1.4.4444 &gt; 10.20.1.10.12345</code></strong> â€“ Zobrazuje zdrojovou a cÃ­lovou IP adresu a porty.</li>
<li><strong><code>length 60</code></strong> â€“ DÃ©lka dat v paketu.</li>
<li><strong>Data (hexadecimÃ¡lnÃ­ formÃ¡t)</strong> â€“ HexadecimÃ¡lnÃ­ reprezentace datovÃ©ho obsahu paketu.</li>
</ul>
<p><a href="../index.html">â† ZpÄ›t na pÅ™ehled</a></p>
</body>
</html>