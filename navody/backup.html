<!DOCTYPE html>
<html>
<head><meta charset="UTF-8"><title>backup ‚Äì z√°lohov√°n√≠ do RPi5</title></head>
<body>
<h1>üöÄ Kompletn√≠ n√°vod: ≈†ifrovan√Ω intranetov√Ω cloud pro z√°lohov√°n√≠ ze dvou Windows notebook≈Ø na RPi5 s NVMe diskem</h1>
<h1>1Ô∏è‚É£ P≈ô√≠prava RPi: aktualizace a slo≈æky</h1>
<p>sudo apt update &amp;&amp; sudo apt upgrade -y
sudo mkdir -p /mnt/cloud-notebook1-container /mnt/cloud-notebook2-container</p>
<h1>(Pokud NVMe je≈°tƒõ nen√≠ p≈ôipojen√Ω)</h1>
<p>lsblk  # zkontroluj za≈ô√≠zen√≠
sudo mkfs.ext4 /dev/nvme0n1p1  # POZOR: sma≈æe data!
sudo mount /dev/nvme0n1p1 /mnt</p>
<h1>2Ô∏è‚É£ Vytvo≈ôen√≠ pr√°zdn√Ωch VeraCrypt kontejner≈Ø (50GB)</h1>
<p>sudo fallocate -l 50G /mnt/cloud-notebook1-container/backup1.vc
sudo fallocate -l 50G /mnt/cloud-notebook2-container/backup2.vc</p>
<h1>3Ô∏è‚É£ Na Windows:</h1>
<h1>- vytvo≈ô kontejnery p≈ôes VeraCrypt GUI (https://www.veracrypt.fr/en/Downloads.html)</h1>
<h1>- nastav siln√© heslo, souborov√Ω syst√©m NTFS/ext4</h1>
<h1>- p≈ôenes kontejnerov√© soubory (.vc) zpƒõt na RPi do p≈ô√≠slu≈°n√Ωch slo≈æek</h1>
<h1>4Ô∏è‚É£ Instalace bal√≠ƒçk≈Ø na RPi</h1>
<p>sudo apt install veracrypt openssh-server samba -y
sudo systemctl enable --now ssh</p>
<h1>5Ô∏è‚É£ P≈ôipojen√≠ VeraCrypt kontejner≈Ø na RPi (p≈ôidej sv√© heslo)</h1>
<p>sudo veracrypt --mount /mnt/cloud-notebook1-container/backup1.vc /mnt/cloud-notebook1 --password="TvojeSilneHeslo" --non-interactive
sudo veracrypt --mount /mnt/cloud-notebook2-container/backup2.vc /mnt/cloud-notebook2 --password="TvojeSilneHeslo" --non-interactive</p>
<h1>6Ô∏è‚É£ Samba sd√≠len√≠ (voliteln√©)</h1>
<h1>Uprav /etc/samba/smb.conf p≈ôid√°n√≠m:</h1>
<h1>[notebook1]</h1>
<h1>path = /mnt/cloud-notebook1</h1>
<h1>valid users = liko</h1>
<h1>read only = no</h1>
<h1></h1>
<h1>[notebook2]</h1>
<h1>path = /mnt/cloud-notebook2</h1>
<h1>valid users = liko</h1>
<h1>read only = no</h1>
<p>sudo smbpasswd -a liko
sudo systemctl restart smbd</p>
<h1>7Ô∏è‚É£ Z√°lohov√°n√≠ z Windows</h1>
<h1>- P≈ôipoj Samba sd√≠len√≠ v Pr≈Øzkumn√≠ku: \IP_RPi\notebook1 a \IP_RPi\notebook2</h1>
<h1>- Nebo rsync p≈ôes WSL / DeltaCopy:</h1>
<h1>rsync -avz /mnt/c/Users/uzivatel/Documents/ liko@IP_RPi:/mnt/cloud-notebook1/</h1>
<h1>8Ô∏è‚É£ Automatick√Ω skript na RPi pro z√°lohy:</h1>
<p>cat &lt;&lt; 'EOF' &gt; ~/backup-cloud.sh</p>
<h1>!/bin/bash</h1>
<p>veracrypt --mount /mnt/cloud-notebook1-container/backup1.vc /mnt/cloud-notebook1 --password="TvojeSilneHeslo" --non-interactive
veracrypt --mount /mnt/cloud-notebook2-container/backup2.vc /mnt/cloud-notebook2 --password="TvojeSilneHeslo" --non-interactive</p>
<p>rsync -av --delete /home/liko/notebook1_data/ /mnt/cloud-notebook1/
rsync -av --delete /home/liko/notebook2_data/ /mnt/cloud-notebook2/</p>
<p>veracrypt -d /mnt/cloud-notebook1
veracrypt -d /mnt/cloud-notebook2
EOF</p>
<p>chmod +x ~/backup-cloud.sh</p>
<h1>9Ô∏è‚É£ Automatick√© p≈ôipojen√≠ VeraCrypt kontejner≈Ø p≈ôi startu RPi</h1>
<h1>Vytvo≈ô systemd slu≈æbu:</h1>
<p>cat &lt;&lt; 'EOF' | sudo tee /etc/systemd/system/veracrypt-mount.service
[Unit]
Description=Mount VeraCrypt containers at boot
After=network-online.target
Wants=network-online.target</p>
<p>[Service]
Type=oneshot
ExecStart=/usr/bin/veracrypt --mount /mnt/cloud-notebook1-container/backup1.vc /mnt/cloud-notebook1 --password="TvojeSilneHeslo" --non-interactive
ExecStart=/usr/bin/veracrypt --mount /mnt/cloud-notebook2-container/backup2.vc /mnt/cloud-notebook2 --password="TvojeSilneHeslo" --non-interactive
RemainAfterExit=yes</p>
<p>[Install]
WantedBy=multi-user.target
EOF</p>
<h1>Aktivuj slu≈æbu:</h1>
<p>sudo systemctl daemon-reload
sudo systemctl enable veracrypt-mount.service
sudo systemctl start veracrypt-mount.service</p>
<h1>10Ô∏è‚É£ PowerShell skript pro Windows z√°lohy na RPi (pomoc√≠ rsync p≈ôes WSL)</h1>
<h1>Ulo≈æ jako backup.ps1 na Windows (upravit IP a cesty):</h1>
<p>$source1 = "C:\Users\uzivatel\Documents\"
$source2 = "C:\Users\uzivatel\Pictures\"
$dest1 = "liko@IP_RPi:/mnt/cloud-notebook1/"
$dest2 = "liko@IP_RPi:/mnt/cloud-notebook2/"</p>
<h1>Nastav cestu k WSL rsync</h1>
<p>$rsync = "C:\Windows\System32\wsl.exe"</p>
<p>Write-Host "Spou≈°t√≠m z√°lohu Documents..."
&amp; $rsync rsync -avz --delete "$source1" "$dest1"</p>
<p>Write-Host "Spou≈°t√≠m z√°lohu Pictures..."
&amp; $rsync rsync -avz --delete "$source2" "$dest2"</p>
<p>Write-Host "Z√°lohov√°n√≠ dokonƒçeno."</p>
<h1>------------------------------------</h1>
<h1>üîó U≈æitoƒçn√© zdroje:</h1>
<h1>- VeraCrypt: https://www.veracrypt.fr/en/Home.html</h1>
<h1>- Rsync for Windows (WSL): https://learn.microsoft.com/en-us/windows/wsl/</h1>
<h1>- Samba: https://www.samba.org/samba/docs/current/man-html/smb.conf.5.html</h1>
<h1>- RPi NVMe disk setup: https://www.raspberrypi.com/documentation/computers/storage.html</h1>
<p><a href="../index.html">‚Üê Zpƒõt na p≈ôehled</a></p>
</body>
</html>